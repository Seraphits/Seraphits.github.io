"use strict";(self.wpRiseJsonp=self.wpRiseJsonp||[]).push([["recorder"],{48560:(ye,$,T)=>{T.r($),T.d($,{startRecording:()=>Se});var B=T(4795),rt=T(89177),H=T(79925),it=T(57458),z=T(39016),M=T(11889),v=T(33564);const w={FullSnapshot:2,IncrementalSnapshot:3,Meta:4,Focus:6,ViewEnd:7,VisualViewport:8,FrustrationRecord:9},R={Document:0,DocumentType:1,Element:2,Text:3,CDATA:4,DocumentFragment:11},y={Mutation:0,MouseMove:1,MouseInteraction:2,Scroll:3,ViewportResize:4,Input:5,TouchMove:6,MediaInteraction:7,StyleSheetRule:8},I={MouseUp:0,MouseDown:1,Click:2,ContextMenu:3,DblClick:4,Focus:5,Blur:6,TouchStart:7,TouchEnd:9},U={Play:0,Pause:1};var d=T(96036);function G(t){return!!t.changedTouches}function b(t){return t.composed===!0&&(0,d.XS)(t.target)?t.composedPath()[0]:t.target}const W=25;function ut(t){return Math.abs(t.pageTop-t.offsetTop-window.scrollY)>W||Math.abs(t.pageLeft-t.offsetLeft-window.scrollX)>W}const at=(t,n)=>{const e=window.visualViewport,s={layoutViewportX:t,layoutViewportY:n,visualViewportX:t,visualViewportY:n};if(e)ut(e)?(s.layoutViewportX=Math.round(t+e.offsetLeft),s.layoutViewportY=Math.round(n+e.offsetTop)):(s.visualViewportX=Math.round(t-e.offsetLeft),s.visualViewportY=Math.round(n-e.offsetTop));else return s;return s},J=t=>({scale:t.scale,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,pageLeft:t.pageLeft,pageTop:t.pageTop,height:t.height,width:t.width});var E=T(20806);function N(t,n){return{data:{source:t,...n},type:w.IncrementalSnapshot,timestamp:(0,E.nx)()}}const ct=50;function lt(t,n,e){const{throttled:s,cancel:o}=(0,M.n)(r=>{const a=b(r),u=n.nodeIds.get(a);if(u===void 0)return;const c=X(r);if(!c)return;const l={id:u,timeOffset:0,x:c.x,y:c.y};e(N(G(r)?y.TouchMove:y.MouseMove,{positions:[l]}))},ct,{trailing:!1}),{stop:i}=(0,v.l)(t,document,["mousemove","touchmove"],s,{capture:!0,passive:!0});return{stop:()=>{i(),o()}}}function X(t){let{clientX:n,clientY:e}=G(t)?t.changedTouches[0]:t;if(window.visualViewport){const{visualViewportX:s,visualViewportY:o}=at(n,e);n=s,e=o}if(!(!Number.isFinite(n)||!Number.isFinite(e)))return{x:n,y:e}}const Y={pointerup:I.MouseUp,mousedown:I.MouseDown,click:I.Click,contextmenu:I.ContextMenu,dblclick:I.DblClick,focus:I.Focus,blur:I.Blur,touchstart:I.TouchStart,touchend:I.TouchEnd};function dt(t,n,e,s){const o=i=>{const r=b(i),a=n.nodeIds.get(r);if(a===void 0||(0,d.PJ)(r,t.defaultPrivacyLevel)===d.$m.HIDDEN)return;const u=Y[i.type];let c;if(u!==I.Blur&&u!==I.Focus){const f=X(i);if(!f)return;c={id:a,type:u,x:f.x,y:f.y}}else c={id:a,type:u};const l={id:s.getIdForEvent(i),...N(y.MouseInteraction,c)};e(l)};return(0,v.l)(t,document,Object.keys(Y),o,{capture:!0,passive:!0})}const ft=100;function j(t,n,e,s,o=document){const{throttled:i,cancel:r}=(0,M.n)(u=>{const c=b(u);if(!c)return;const l=n.nodeIds.get(c);if(l===void 0||(0,d.PJ)(c,t.defaultPrivacyLevel)===d.$m.HIDDEN)return;const f=c===document?{scrollTop:(0,d.zL)(),scrollLeft:(0,d.Gn)()}:{scrollTop:Math.round(c.scrollTop),scrollLeft:Math.round(c.scrollLeft)};s.set(c,f),e(N(y.Scroll,{id:l,x:f.scrollLeft,y:f.scrollTop}))},ft),{stop:a}=(0,v.q)(t,o,"scroll",i,{capture:!0,passive:!0});return{stop:()=>{a(),r()}}}const pt=200;function ht(t,n){const e=(0,d.g1)(t).subscribe(s=>{n(N(y.ViewportResize,s))});return{stop:()=>{e.unsubscribe()}}}function mt(t,n){const e=window.visualViewport;if(!e)return{stop:M.l};const{throttled:s,cancel:o}=(0,M.n)(()=>{n({data:J(e),type:w.VisualViewport,timestamp:(0,E.nx)()})},pt,{trailing:!1}),{stop:i}=(0,v.l)(t,e,["resize","scroll"],s,{capture:!0,passive:!0});return{stop:()=>{i(),o()}}}function gt(t,n,e){return(0,v.l)(t,document,["play","pause"],s=>{const o=b(s);if(!o)return;const i=n.nodeIds.get(o);i===void 0||(0,d.PJ)(o,t.defaultPrivacyLevel)===d.$m.HIDDEN||e(N(y.MediaInteraction,{id:i,type:s.type==="play"?U.Play:U.Pause}))},{capture:!0,passive:!0})}var x=T(83384);function St(t,n){function e(i,r){if(!i||!i.ownerNode)return;const a=t.nodeIds.get(i.ownerNode);a!==void 0&&r(a)}const s=[(0,x.H)(CSSStyleSheet.prototype,"insertRule",({target:i,parameters:[r,a]})=>{e(i,u=>n(N(y.StyleSheetRule,{id:u,adds:[{rule:r,index:a}]})))}),(0,x.H)(CSSStyleSheet.prototype,"deleteRule",({target:i,parameters:[r]})=>{e(i,a=>n(N(y.StyleSheetRule,{id:a,removes:[{index:r}]})))})];typeof CSSGroupingRule<"u"?o(CSSGroupingRule):(o(CSSMediaRule),o(CSSSupportsRule));function o(i){s.push((0,x.H)(i.prototype,"insertRule",({target:r,parameters:[a,u]})=>{e(r.parentStyleSheet,c=>{const l=K(r);l&&(l.push(u||0),n(N(y.StyleSheetRule,{id:c,adds:[{rule:a,index:l}]})))})}),(0,x.H)(i.prototype,"deleteRule",({target:r,parameters:[a]})=>{e(r.parentStyleSheet,u=>{const c=K(r);c&&(c.push(a),n(N(y.StyleSheetRule,{id:u,removes:[{index:c}]})))})}))}return{stop:()=>{s.forEach(i=>i.stop())}}}function K(t){const n=[];let e=t;for(;e.parentRule;){const r=Array.from(e.parentRule.cssRules).indexOf(e);n.unshift(r),e=e.parentRule}if(!e.parentStyleSheet)return;const o=Array.from(e.parentStyleSheet.cssRules).indexOf(e);return n.unshift(o),n}function Tt(t,n){return(0,v.l)(t,window,["focus","blur"],()=>{n({data:{has_focus:document.hasFocus()},type:w.Focus,timestamp:(0,E.nx)()})})}function yt(t,n,e){const s=t.subscribe(12,o=>{var i,r;o.rawRumEvent.type===d.bb.ACTION&&o.rawRumEvent.action.type===d.X2.CLICK&&(!((r=(i=o.rawRumEvent.action.frustration)===null||i===void 0?void 0:i.type)===null||r===void 0)&&r.length)&&"events"in o.domainContext&&o.domainContext.events&&o.domainContext.events.length&&n({timestamp:o.rawRumEvent.date,type:w.FrustrationRecord,data:{frustrationTypes:o.rawRumEvent.action.frustration.type,recordIds:o.domainContext.events.map(a=>e.getIdForEvent(a))}})});return{stop:()=>{s.unsubscribe()}}}function Et(t,n){const e=t.subscribe(5,()=>{n({timestamp:(0,E.nx)(),type:w.ViewEnd})});return{stop:()=>{e.unsubscribe()}}}var It=T(43734);function L(t,n){const e=t.tagName,s=t.value;if((0,d.Ie)(t,n)){const o=t.type;return e==="INPUT"&&(o==="button"||o==="submit"||o==="reset")?s:!s||e==="OPTION"?void 0:d.o}if(e==="OPTION"||e==="SELECT")return t.value;if(!(e!=="INPUT"&&e!=="TEXTAREA"))return s}const Nt=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,Mt=/^[A-Za-z]+:|^\/\//,wt=/^["']?data:.*,/i;function xt(t,n){return t.replace(Nt,(e,s,o,i,r,a)=>{const u=o||r||a;if(!n||!u||Mt.test(u)||wt.test(u))return e;const c=s||i||"";return`url(${c}${vt(u,n)}${c})`})}function vt(t,n){try{return(0,It.c$)(t,n).href}catch{return t}}const Rt=/[^a-z1-6-_]/;function _(t){const n=t.toLowerCase().trim();return Rt.test(n)?"div":n}function Z(t,n){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${t}' height='${n}' style='background-color:silver'%3E%3C/svg%3E`}function Q(t){if(!(t===void 0||t.length===0))return t.map(n=>{const e=n.cssRules||n.rules;return{cssRules:Array.from(e,i=>i.cssText),disabled:n.disabled||void 0,media:n.media.length>0?Array.from(n.media):void 0}})}var Ct=T(8965);const bt=1e6;function q(t,n,e,s){if(n===d.$m.HIDDEN)return null;const o=t.getAttribute(e);if(n===d.$m.MASK&&e!==d.NT&&!d.yF.includes(e)&&e!==s.actionNameAttribute){const i=t.tagName;switch(e){case"title":case"alt":case"placeholder":return d.o}if(i==="IMG"&&(e==="src"||e==="srcset")){const r=t;if(r.naturalWidth>0)return Z(r.naturalWidth,r.naturalHeight);const{width:a,height:u}=t.getBoundingClientRect();return a>0||u>0?Z(a,u):d.eT}if(i==="SOURCE"&&(e==="src"||e==="srcset"))return d.eT;if(i==="A"&&e==="href"||o&&e.startsWith("data-")||i==="IFRAME"&&e==="srcdoc")return d.o}return!o||typeof o!="string"?o:(0,d.ei)(o,bt)}function O(){return{cssText:{count:0,max:0,sum:0},serializationDuration:{count:0,max:0,sum:0}}}function A(t,n,e){t[n].count+=1,t[n].max=Math.max(t[n].max,e),t[n].sum+=e}function Dt(t,n){for(const e of["cssText","serializationDuration"])t[e].count+=n[e].count,t[e].max=Math.max(t[e].max,n[e].max),t[e].sum+=n[e].sum}function zt(t,n,e){if(n===d.$m.HIDDEN)return{};const s={},o=_(t.tagName),i=t.ownerDocument;for(let l=0;l<t.attributes.length;l+=1){const p=t.attributes.item(l).name,h=q(t,n,p,e.configuration);h!==null&&(s[p]=h)}if(t.value&&(o==="textarea"||o==="select"||o==="option"||o==="input")){const l=L(t,n);l!==void 0&&(s.value=l)}if(o==="option"&&n===d.$m.ALLOW){const l=t;l.selected&&(s.selected=l.selected)}if(o==="link"){const l=Array.from(i.styleSheets).find(p=>p.href===t.href),f=V(l);f&&l&&(A(e.serializationContext.serializationStats,"cssText",f.length),s._cssText=f)}if(o==="style"&&t.sheet){const l=V(t.sheet);l&&(A(e.serializationContext.serializationStats,"cssText",l.length),s._cssText=l)}const r=t;if(o==="input"&&(r.type==="radio"||r.type==="checkbox")&&(n===d.$m.ALLOW?s.checked=!!r.checked:(0,d.Ie)(r,n)&&delete s.checked),o==="audio"||o==="video"){const l=t;s.rr_mediaState=l.paused?"paused":"played"}let a,u;const c=e.serializationContext;switch(c.status){case 0:a=Math.round(t.scrollTop),u=Math.round(t.scrollLeft),(a||u)&&c.elementsScrollPositions.set(t,{scrollTop:a,scrollLeft:u});break;case 1:c.elementsScrollPositions.has(t)&&({scrollTop:a,scrollLeft:u}=c.elementsScrollPositions.get(t));break}return u&&(s.rr_scrollLeft=u),a&&(s.rr_scrollTop=a),s}function V(t){if(!t)return null;let n;try{n=t.rules||t.cssRules}catch{}if(!n)return null;const e=Array.from(n,(0,Ct.nr)()?At:tt).join("");return xt(e,t.href)}function At(t){if(Ot(t)&&t.selectorText.includes(":")){const n=/(\[[\w-]+[^\\])(:[^\]]+\])/g;return t.cssText.replace(n,"$1\\$2")}return tt(t)}function tt(t){return Lt(t)&&V(t.styleSheet)||t.cssText}function Lt(t){return"styleSheet"in t}function Ot(t){return"selectorText"in t}function P(t,n,e){const s=Vt(t,n,e);if(!s)return null;const o=e.scope.nodeIds.assign(t),i=s;return i.id=o,e.serializedNodeIds&&e.serializedNodeIds.add(o),i}function F(t,n,e){const s=[];return(0,d.wI)(t,o=>{const i=P(o,n,e);i&&s.push(i)}),s}function Vt(t,n,e){switch(t.nodeType){case t.DOCUMENT_NODE:return Pt(t,n,e);case t.DOCUMENT_FRAGMENT_NODE:return Ft(t,n,e);case t.DOCUMENT_TYPE_NODE:return kt(t);case t.ELEMENT_NODE:return $t(t,n,e);case t.TEXT_NODE:return Ht(t,n);case t.CDATA_SECTION_NODE:return Ut()}}function Pt(t,n,e){return{type:R.Document,childNodes:F(t,n,e),adoptedStyleSheets:Q(t.adoptedStyleSheets)}}function Ft(t,n,e){const s=(0,d.p_)(t);return s&&e.serializationContext.shadowRootsController.addShadowRoot(t),{type:R.DocumentFragment,childNodes:F(t,n,e),isShadowRoot:s,adoptedStyleSheets:s?Q(t.adoptedStyleSheets):void 0}}function kt(t){return{type:R.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId}}function $t(t,n,e){const s=_(t.tagName),o=Bt(t)||void 0,i=(0,d.jR)((0,d.dT)(t),n);if(i===d.$m.HIDDEN){const{width:u,height:c}=t.getBoundingClientRect();return{type:R.Element,tagName:s,attributes:{rr_width:`${u}px`,rr_height:`${c}px`,[d.NT]:d.Wd},childNodes:[],isSVG:o}}if(i===d.$m.IGNORE)return;const r=zt(t,i,e);let a=[];return(0,d.wR)(t)&&s!=="style"&&(a=F(t,i,e)),{type:R.Element,tagName:s,attributes:r,childNodes:a,isSVG:o}}function Bt(t){return t.tagName==="svg"||t instanceof SVGElement}function Ht(t,n){const e=(0,d.rf)(t,n);if(e!==void 0)return{type:R.Text,textContent:e}}function Ut(){return{type:R.CDATA,textContent:""}}function Gt(t,n,e,s){const o=(0,E.nx)(),i=P(t,n.defaultPrivacyLevel,{serializationContext:s,configuration:n,scope:e});return A(s.serializationStats,"serializationDuration",(0,E.vk)(o,(0,E.nx)())),i}function Wt(t){return{nodeIds:t}}function et(t,n,e,s=document){const o=t.defaultPrivacyLevel,i=new WeakMap,r=s!==document,{stop:a}=(0,v.l)(t,s,r?["change"]:["input","change"],f=>{const p=b(f);(p instanceof HTMLInputElement||p instanceof HTMLTextAreaElement||p instanceof HTMLSelectElement)&&c(p)},{capture:!0,passive:!0});let u;if(r)u=M.l;else{const f=[(0,x.t)(HTMLInputElement.prototype,"value",c),(0,x.t)(HTMLInputElement.prototype,"checked",c),(0,x.t)(HTMLSelectElement.prototype,"value",c),(0,x.t)(HTMLTextAreaElement.prototype,"value",c),(0,x.t)(HTMLSelectElement.prototype,"selectedIndex",c)];u=()=>{f.forEach(p=>p.stop())}}return{stop:()=>{u(),a()}};function c(f){const p=(0,d.PJ)(f,o);if(p===d.$m.HIDDEN)return;const h=f.type;let S;if(h==="radio"||h==="checkbox"){if((0,d.Ie)(f,p))return;S={isChecked:f.checked}}else{const g=L(f,p);if(g===void 0)return;S={text:g}}l(f,S,n);const m=f.name;h==="radio"&&m&&f.checked&&document.querySelectorAll(`input[type="radio"][name="${CSS.escape(m)}"]`).forEach(g=>{g!==f&&l(g,{isChecked:!1},n)})}function l(f,p,h){const S=h.nodeIds.get(f);if(S===void 0)return;const m=i.get(f);(!m||m.text!==p.text||m.isChecked!==p.isChecked)&&(i.set(f,p),e(N(y.Input,{id:S,...p})))}}var Jt=T(67656),Xt=T(79330);const Yt=100,jt=16;function Kt(t){let n=M.l,e=[];function s(){n(),t(e),e=[]}const{throttled:o,cancel:i}=(0,M.n)(s,jt,{leading:!1});return{addMutations:r=>{e.length===0&&(n=(0,Xt.BB)(o,{timeout:Yt})),e.push(...r)},flush:s,stop:()=>{n(),i()}}}function nt(t,n,e,s,o){const i=(0,d.W3)();if(!i)return{stop:M.l,flush:M.l};const r=Kt(u=>{_t(u.concat(a.takeRecords()),t,n,e,s)}),a=new i((0,Jt.dm)(r.addMutations));return a.observe(o,{attributeOldValue:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{stop:()=>{a.disconnect(),r.stop()},flush:()=>{r.flush()}}}function _t(t,n,e,s,o){const i=new Map;t.filter(h=>h.type==="childList").forEach(h=>{h.removedNodes.forEach(S=>{ot(S,o.removeShadowRoot)})});const r=t.filter(h=>h.target.isConnected&&s.nodeIds.areAssignedForNodeAndAncestors(h.target)&&(0,d.PJ)(h.target,e.defaultPrivacyLevel,i)!==d.$m.HIDDEN),a=O(),{adds:u,removes:c,hasBeenSerialized:l}=Zt(r.filter(h=>h.type==="childList"),e,s,a,o,i),f=Qt(r.filter(h=>h.type==="characterData"&&!l(h.target)),e,s,i),p=qt(r.filter(h=>h.type==="attributes"&&!l(h.target)),e,s,i);!f.length&&!p.length&&!c.length&&!u.length||n(N(y.Mutation,{adds:u,removes:c,texts:f,attributes:p}),a)}function Zt(t,n,e,s,o,i){const r=new Set,a=new Map;for(const m of t)m.addedNodes.forEach(g=>{r.add(g)}),m.removedNodes.forEach(g=>{r.has(g)||a.set(g,m.target),r.delete(g)});const u=Array.from(r);te(u);const c=new Set,l={status:2,serializationStats:s,shadowRootsController:o},f=[];for(const m of u){if(h(m))continue;const g=(0,d.PJ)(m.parentNode,n.defaultPrivacyLevel,i);if(g===d.$m.HIDDEN||g===d.$m.IGNORE)continue;const C=(0,E.nx)(),D=P(m,g,{serializedNodeIds:c,serializationContext:l,configuration:n,scope:e});if(A(s,"serializationDuration",(0,E.vk)(C,(0,E.nx)())),!D)continue;const Te=(0,d.$4)(m);f.push({nextId:S(m),parentId:e.nodeIds.get(Te),node:D})}const p=[];return a.forEach((m,g)=>{const C=e.nodeIds.get(m),D=e.nodeIds.get(g);C!==void 0&&D!==void 0&&p.push({parentId:C,id:D})}),{adds:f,removes:p,hasBeenSerialized:h};function h(m){const g=e.nodeIds.get(m);return g!==void 0&&c.has(g)}function S(m){let g=m.nextSibling;for(;g;){const C=e.nodeIds.get(g);if(C!==void 0)return C;g=g.nextSibling}return null}}function Qt(t,n,e,s){var o;const i=[],r=new Set,a=t.filter(u=>r.has(u.target)?!1:(r.add(u.target),!0));for(const u of a){if(u.target.textContent===u.oldValue)continue;const l=e.nodeIds.get(u.target);if(l===void 0)continue;const f=(0,d.PJ)((0,d.$4)(u.target),n.defaultPrivacyLevel,s);f===d.$m.HIDDEN||f===d.$m.IGNORE||i.push({id:l,value:(o=(0,d.rf)(u.target,f))!==null&&o!==void 0?o:null})}return i}function qt(t,n,e,s){const o=[],i=new Map,r=t.filter(u=>{const c=i.get(u.target);return c&&c.has(u.attributeName)?!1:(c?c.add(u.attributeName):i.set(u.target,new Set([u.attributeName])),!0)}),a=new Map;for(const u of r){if(u.target.getAttribute(u.attributeName)===u.oldValue)continue;const l=e.nodeIds.get(u.target);if(l===void 0)continue;const f=(0,d.PJ)(u.target,n.defaultPrivacyLevel,s),p=q(u.target,f,u.attributeName,n);let h;if(u.attributeName==="value"){const m=L(u.target,f);if(m===void 0)continue;h=m}else typeof p=="string"?h=p:h=null;let S=a.get(u.target);S||(S={id:l,attributes:{}},o.push(S),a.set(u.target,S)),S.attributes[u.attributeName]=h}return o}function te(t){t.sort((n,e)=>{const s=n.compareDocumentPosition(e);return s&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:s&Node.DOCUMENT_POSITION_CONTAINS||s&Node.DOCUMENT_POSITION_FOLLOWING?1:s&Node.DOCUMENT_POSITION_PRECEDING?-1:0})}function ot(t,n){(0,d.XS)(t)&&n(t.shadowRoot),(0,d.wI)(t,e=>ot(e,n))}function ee(){const t=new WeakMap;return{set(n,e){n===document&&!document.scrollingElement||t.set(n===document?document.scrollingElement:n,e)},get(n){return t.get(n)},has(n){return t.has(n)}}}const ne=(t,n,e,s)=>{const o=new Map,i={addShadowRoot:r=>{if(o.has(r))return;const a=nt(e,t,n,i,r),u=et(t,n,e,r),c=j(t,n,e,s,r);o.set(r,{flush:()=>a.flush(),stop:()=>{a.stop(),u.stop(),c.stop()}})},removeShadowRoot:r=>{const a=o.get(r);a&&(a.stop(),o.delete(r))},stop:()=>{o.forEach(({stop:r})=>r())},flush:()=>{o.forEach(({flush:r})=>r())}};return i};function oe(t,n,e,s,o,i,r){const a=(c,l)=>{const{width:f,height:p}=(0,d.pB)();r({data:{height:p,href:window.location.href,width:f},type:w.Meta,timestamp:c}),r({data:{has_focus:document.hasFocus()},type:w.Focus,timestamp:c});const h=O();r({data:{node:Gt(document,s,o,{status:l,elementsScrollPositions:t,serializationStats:h,shadowRootsController:n}),initialOffset:{left:(0,d.Gn)(),top:(0,d.zL)()}},type:w.FullSnapshot,timestamp:c},h),window.visualViewport&&r({data:J(window.visualViewport),type:w.VisualViewport,timestamp:c})};a((0,E.nx)(),0);const{unsubscribe:u}=e.subscribe(2,c=>{i(),a(c.startClocks.timeStamp,1)});return{stop:u}}function se(){const t=new WeakMap;let n=1;return{getIdForEvent(e){return t.has(e)||t.set(e,n++),t.get(e)}}}function re(){const t=new WeakMap;let n=1;const e=s=>t.get(s);return{assign:s=>{let o=e(s);return o===void 0&&(o=n++,t.set(s,o)),o},get:e,areAssignedForNodeAndAncestors:s=>{let o=s;for(;o;){if(e(o)===void 0&&!(0,d.p_)(o))return!1;o=(0,d.$4)(o)}return!0}}}function ie(t){const{emit:n,configuration:e,lifeCycle:s}=t;if(!n)throw new Error("emit function is required");const o=(h,S)=>{n(h,S),(0,it.b)("record",{record:h});const m=t.viewHistory.findView();z.$1(m.id)},i=ee(),r=Wt(re()),a=ne(e,r,o,i),{stop:u}=oe(i,a,s,e,r,c,o);function c(){a.flush(),f.flush()}const l=se(),f=nt(o,e,r,a,document),p=[f,lt(e,r,o),dt(e,r,o,l),j(e,r,o,i,document),ht(e,o),et(e,r,o),gt(e,r,o),St(r,o),Tt(e,o),mt(e,o),yt(s,o,l),Et(s,h=>{c(),o(h)})];return{stop:()=>{a.stop(),p.forEach(h=>h.stop()),u()},flushMutations:c,shadowRootsController:a}}var ue=T(19948),st=T(62679);function ae(t,n,e,s){const o=new FormData;o.append("segment",new Blob([t],{type:"application/octet-stream"}),`${n.session.id}-${n.start}`);const i={raw_segment_size:s,compressed_segment_size:t.byteLength,...n},r=JSON.stringify(i);return o.append("event",new Blob([r],{type:"application/json"})),{data:o,bytesCount:t.byteLength,cssText:e.cssText,isFullSnapshot:n.index_in_view===0,rawSize:s,recordCount:n.records_count,serializationDuration:e.serializationDuration}}function ce({context:t,creationReason:n,encoder:e}){let s=0;const o=t.view.id,i=z.K_(o),r={start:1/0,end:-1/0,creation_reason:n,records_count:0,has_full_snapshot:!1,index_in_view:i,source:"browser",...t},a=O();z.H5(o);function u(l,f,p){r.start=Math.min(r.start,l.timestamp),r.end=Math.max(r.end,l.timestamp),r.records_count+=1,r.has_full_snapshot||(r.has_full_snapshot=l.type===w.FullSnapshot),f&&Dt(a,f);const h=e.isEmpty?'{"records":[':",";e.write(h+JSON.stringify(l),S=>{s+=S,p(s)})}function c(l){if(e.isEmpty)throw new Error("Empty segment flushed");e.write(`],${JSON.stringify(r).slice(1)}
`),e.finish(f=>{z.L7(r.view.id,f.rawBytesCount),l(r,a,f)})}return{addRecord:u,flush:c}}const le=5*E.OY;let k=6e4;function de(t,n,e,s,o,i){return fe(t,()=>pe(n.applicationId,e,s),o,i)}function fe(t,n,e,s){let o={status:0,nextSegmentCreationReason:"init"};const{unsubscribe:i}=t.subscribe(2,()=>{a("view_change")}),{unsubscribe:r}=t.subscribe(11,u=>{a(u.reason)});function a(u){o.status===1&&(o.segment.flush((c,l,f)=>{const p=ae(f.output,c,l,f.rawBytesCount);(0,ue.Kp)(u)?e.sendOnExit(p):e.send(p)}),(0,st.DJ)(o.expirationTimeoutId)),u!=="stop"?o={status:0,nextSegmentCreationReason:u}:o={status:2}}return{addRecord:(u,c)=>{if(o.status!==2){if(o.status===0){const l=n();if(!l)return;o={status:1,segment:ce({encoder:s,context:l,creationReason:o.nextSegmentCreationReason}),expirationTimeoutId:(0,st.wg)(()=>{a("segment_duration_limit")},le)}}o.segment.addRecord(u,c,l=>{l>k&&a("segment_bytes_limit")})}},stop:()=>{a("stop"),i(),r()}}}function pe(t,n,e){const s=n.findTrackedSession(),o=e.findView();if(!(!s||!o))return{application:{id:t},session:{id:s.id},view:{id:o.id}}}function Ee(t=6e4){k=t}function he(t,n){if(!t.metricsEnabled)return{stop:M.l};const{unsubscribe:e}=n.subscribe(s=>{if(s.type==="failure"||s.type==="queue-full"||s.type==="success"&&s.payload.isFullSnapshot){const o=me(s.type,s.bandwidth,s.payload);(0,B.Gk)("Segment network request metrics",{metrics:o})}});return{stop:e}}function me(t,n,e){return{cssText:{count:e.cssText.count,max:e.cssText.max,sum:e.cssText.sum},isFullSnapshot:e.isFullSnapshot,ongoingRequests:{count:n.ongoingRequestCount,totalSize:n.ongoingByteCount},recordCount:e.recordCount,result:t,serializationDuration:{count:e.serializationDuration.count,max:e.serializationDuration.max,sum:e.serializationDuration.sum},size:{compressed:e.bytesCount,raw:e.rawSize}}}function ge(t){const n=(0,H.Y9)();return{addRecord:e=>{const s=t.findView();n.send("record",e,s.id)}}}function Se(t,n,e,s,o,i,r){const a=[],u=p=>{t.notify(14,{error:p}),(0,B.A2)("Error reported to customer",{"error.message":p.message})},c=r||(0,rt.sA)([n.sessionReplayEndpointBuilder],k,u);let l;if((0,H.d0)())({addRecord:l}=ge(s));else{const p=de(t,n,e,s,c,o);l=p.addRecord,a.push(p.stop);const h=he(i,c.observable);a.push(h.stop)}const{stop:f}=ie({emit:l,configuration:n,lifeCycle:t,viewHistory:s});return a.push(f),{stop:()=>{a.forEach(p=>p())}}}}}]);
